<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - ReshimGathi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        html, body {
            width: 100%;
            min-height: 100%;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        *, *::before, *::after {
            box-sizing: inherit;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(120deg, #f8eaea 0%, #f5f5f5 100%);
            margin: 0;
            padding: 0;
            width: 100vw;
            max-width: 100vw;
        }
        .navbar {
            width: 100%;
            background: #fff;
            box-shadow: 0 2px 12px rgba(179,18,23,0.07);
            padding: 0.7rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .navbar .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            color: #b31217;
            text-decoration: none;
            font-weight: 700;
            letter-spacing: 1px;
        }
        .navbar .profile-btn {
            background: linear-gradient(90deg, #b31217 0%, #6b001b 100%);
            color: #fff;
            border: none;
            border-radius: 20px;
            padding: 0.5rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 2px 8px rgba(179,18,23,0.08);
            transition: background 0.2s;
        }
        .navbar .profile-btn:hover {
            background: #6b001b;
        }
        .settings-container {
            max-width: 700px;
            width: 100%;
            margin: 40px auto 0 auto;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 4px 32px rgba(179,18,23,0.10);
            padding: 2.5rem 2rem 2rem 2rem;
        }
        .settings-title {
            color: #b31217;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
            font-family: 'Playfair Display', serif;
        }
        .settings-section {
            margin-bottom: 2.2rem;
        }
        .section-header {
            font-size: 1.15rem;
            font-weight: 600;
            color: #b31217;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .settings-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .settings-list li {
            background: #f8eaea;
            margin-bottom: 0.7rem;
            padding: 1rem 1.2rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.05rem;
            color: #333;
            box-shadow: 0 2px 8px rgba(179,18,23,0.04);
            transition: background 0.2s;
        }
        .settings-list li:hover {
            background: #f3dede;
        }
        .settings-list li .fa {
            color: #b31217;
            font-size: 1.1rem;
            min-width: 22px;
        }
        .toggle-switch {
            margin-left: auto;
            position: relative;
            width: 44px;
            height: 24px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background: #e0bcbc;
            border-radius: 24px;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: #fff;
            border-radius: 50%;
            transition: .4s;
            box-shadow: 0 2px 6px rgba(179,18,23,0.10);
        }
        .toggle-switch input:checked + .slider {
            background: linear-gradient(90deg, #b31217 0%, #6b001b 100%);
        }
        .toggle-switch input:checked + .slider:before {
            transform: translateX(20px);
        }
        @media (max-width: 900px) {
            .settings-container {
                max-width: 98vw;
                padding: 2rem 1rem 1.5rem 1rem;
            }
        }
        @media (max-width: 600px) {
            .settings-container {
                max-width: 100vw;
                width: 100vw;
                padding: 1.2rem 0.5rem;
            }
            .settings-title {
                font-size: 1.3rem;
            }
            .settings-list li {
                font-size: 0.97rem;
                padding: 0.8rem 0.7rem;
            }
            .section-header {
                font-size: 1rem;
            }
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.25);
            align-items: center;
            justify-content: center;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: #fff;
            border-radius: 18px;
            padding: 2.2rem 2.7rem;
            box-shadow: 0 4px 32px rgba(179,18,23,0.15);
            text-align: center;
            max-width: 370px;
            width: 90vw;
        }
        @media (max-width: 500px) {
            .modal-content {
                padding: 1.2rem 0.5rem;
                max-width: 98vw;
                width: 98vw;
            }
        }
        .faq-list {
            margin-top: 1.2rem;
        }
        .faq-item {
            margin-bottom: 0.7rem;
            border-radius: 10px;
            background: #f8eaea;
            box-shadow: 0 2px 8px rgba(179,18,23,0.04);
            overflow: hidden;
        }
        .faq-question {
            width: 100%;
            background: none;
            border: none;
            outline: none;
            text-align: left;
            font-size: 1.05rem;
            font-weight: 600;
            color: #b31217;
            padding: 1rem 1.2rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        .faq-question:hover {
            background: #f3dede;
        }
        .faq-answer {
            display: none;
            padding: 0 1.2rem 1rem 1.2rem;
            color: #333;
            font-size: 0.98rem;
            line-height: 1.6;
        }
        .faq-item.active .faq-answer {
            display: block;
            animation: fadeIn 0.3s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="navbar">
        <a href="profile.html" class="logo">ReshimGathi</a>
        <button class="profile-btn" onclick="window.location.href='profile.html'">
            <i class="fas fa-user"></i> Go to Profile
        </button>
    </div>
    <div class="settings-container">
        <div class="settings-title">Settings</div>
        <div class="settings-section">
            <div class="section-header"><i class="fas fa-user-cog"></i> Account Settings</div>
            <ul class="settings-list">
                <li onclick="openModal('emailModal')"><i class="fas fa-envelope"></i> Change Email</li>
                <li onclick="openModal('passwordModal')"><i class="fas fa-key"></i> Change Password</li>
                <li onclick="openModal('deleteModal')"><i class="fas fa-trash-alt"></i> Delete Account</li>
            </ul>
        </div>
        <div class="settings-section">
            <div class="section-header"><i class="fas fa-user-edit"></i> Profile Settings</div>
            <ul class="settings-list">
                <li onclick="openModal('editProfileModal')"><i class="fas fa-id-card"></i> Edit Profile Information</li>
                <li onclick="openModal('profilePicModal')"><i class="fas fa-image"></i> Update Profile Picture</li>
                <li onclick="openModal('privacyModal')"><i class="fas fa-eye-slash"></i> Manage Privacy</li>
            </ul>
        </div>
        <div class="settings-section">
            <div class="section-header"><i class="fas fa-bell"></i> Notification Settings</div>
            <ul class="settings-list">
                <li><i class="fas fa-envelope-open-text"></i> Email Notifications
                    <span class="toggle-switch"><input type="checkbox" id="emailNotif" checked onchange="saveToggle('emailNotif')"><span class="slider"></span></span>
                </li>
                <li><i class="fas fa-sms"></i> SMS Notifications
                    <span class="toggle-switch"><input type="checkbox" id="smsNotif" onchange="saveToggle('smsNotif')"><span class="slider"></span></span>
                </li>
                <li><i class="fas fa-lightbulb"></i> Match Suggestions
                    <span class="toggle-switch"><input type="checkbox" id="matchNotif" checked onchange="saveToggle('matchNotif')"><span class="slider"></span></span>
                </li>
            </ul>
        </div>
        <div class="settings-section">
            <div class="section-header"><i class="fas fa-crown"></i> Subscription & Payments</div>
            <ul class="settings-list">
                <li onclick="openModal('currentPlanModal')" style="cursor:pointer"><i class="fas fa-gem"></i> View Current Plan</li>
                <li onclick="window.location.href='pricing.html'" style="cursor:pointer"><i class="fas fa-arrow-up"></i> Upgrade Plan</li>
                <li onclick="window.location.href='payment-history.html'" style="cursor:pointer"><i class="fas fa-receipt"></i> Payment History</li>
            </ul>
        </div>
        <div class="settings-section">
            <div class="section-header"><i class="fas fa-shield-alt"></i> Security</div>
            <ul class="settings-list">
                <li onclick="openModal('twoFactorModal')"><i class="fas fa-lock"></i> Two-Factor Authentication
                    <span class="toggle-switch"><input type="checkbox" id="twoFactor" onchange="saveToggle('twoFactor')"><span class="slider"></span></span>
                </li>
                <li onclick="openModal('loginActivityModal')"><i class="fas fa-history"></i> Recent Login Activity</li>
            </ul>
        </div>
        <div class="settings-section">
            <div class="section-header"><i class="fas fa-headset"></i> Support</div>
            <ul class="settings-list">
                <li onclick="showFAQ()" style="cursor:pointer"><i class="fas fa-question-circle"></i> FAQs</li>
                <li onclick="openModal('supportModal')"><i class="fas fa-envelope"></i> Contact Support</li>
            </ul>
        </div>
        <div class="settings-section" id="faqSection" style="display:none;">
            <div class="section-header"><i class="fas fa-question-circle"></i> Frequently Asked Questions (FAQ)
                <button onclick="hideFAQ()" style="float:right;background:#b31217;color:#fff;border:none;border-radius:6px;padding:0.3rem 1rem;font-size:0.95rem;cursor:pointer;">Close FAQ</button>
            </div>
            <div class="faq-list">
                <div class="faq-item">
                    <button class="faq-question">How do I change my email or password?</button>
                    <div class="faq-answer">Go to Account Settings and click on 'Change Email' or 'Change Password'. A form will appear for you to update your details securely.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">How do I upgrade to a premium plan?</button>
                    <div class="faq-answer">Click on 'Upgrade Plan' in the Subscription & Payments section. You will be redirected to the pricing page to choose and purchase a premium plan.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">How do I contact support?</button>
                    <div class="faq-answer">Open the 'Contact Support' option in the Support section. You can email us at <a href="mailto:bridgeflow24@gmail.com">bridgeflow24@gmail.com</a> or call +91 75005 5838.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">How do I delete my account?</button>
                    <div class="faq-answer">Go to Account Settings and click 'Delete Account'. You will be asked for confirmation before your account is permanently deleted.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">Is my profile information private?</button>
                    <div class="faq-answer">You can manage your privacy in the Profile Settings section. Choose to hide your profile or contact info as you wish.</div>
                </div>
                <div class="faq-item">
                    <button class="faq-question">How do I enable Two-Factor Authentication (2FA)?</button>
                    <div class="faq-answer">Go to the Security section and click on 'Two-Factor Authentication'. Follow the instructions to enable or disable 2FA for your account.</div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modals -->
    <div id="emailModal" class="modal"><div class="modal-content"><h2>Change Email</h2>
        <form id="changeEmailForm" onsubmit="return submitChangeEmail(event)">
            <input type="email" id="newEmail" placeholder="New Email" style="width:90%;padding:0.7rem;margin-bottom:1rem;" required><br>
            <button type="submit">Save</button>
        </form>
    </div></div>
    <div id="passwordModal" class="modal"><div class="modal-content"><h2>Change Password</h2>
        <form id="changePasswordForm" onsubmit="return submitChangePassword(event)">
            <input type="password" id="newPassword" placeholder="New Password" style="width:90%;padding:0.7rem;margin-bottom:1rem;" required><br>
            <button type="submit">Save</button>
        </form>
    </div></div>
    <div id="deleteModal" class="modal"><div class="modal-content"><h2>Delete Account</h2><p>Are you sure? This cannot be undone.</p>
        <button onclick="closeModal('deleteModal')">Cancel</button> 
        <button style="background:#b31217;color:#fff;" onclick="deleteAccount()">Delete</button>
    </div></div>
    <div id="editProfileModal" class="modal"><div class="modal-content"><h2>Edit Profile</h2>
        <form id="editProfileForm" onsubmit="return submitEditProfile(event)">
            <input type="text" id="editName" placeholder="Full Name" style="width:90%;padding:0.7rem;margin-bottom:0.7rem;" required><br>
            <input type="text" id="editPhone" placeholder="Phone" style="width:90%;padding:0.7rem;margin-bottom:0.7rem;"><br>
            <button type="submit">Save</button>
        </form>
    </div></div>
    <div id="profilePicModal" class="modal"><div class="modal-content"><h2>Update Profile Picture</h2>
        <form id="profilePicForm" onsubmit="return submitProfilePic(event)">
            <input type="file" id="newProfilePic" accept="image/*" style="margin-bottom:1rem;" required><br>
            <button type="submit">Save</button>
        </form>
    </div></div>
    <div id="privacyModal" class="modal"><div class="modal-content"><h2>Manage Privacy</h2>
        <form id="privacyForm" onsubmit="return submitPrivacy(event)">
            <label><input type="checkbox" id="hideProfile"> Hide my profile from search</label><br><br>
            <label><input type="checkbox" id="hideContact"> Hide my contact info</label><br><br>
            <button type="submit">Save</button>
        </form>
    </div></div>
    <div id="twoFactorModal" class="modal"><div class="modal-content"><h2>Two-Factor Authentication</h2>
        <form id="twoFactorForm" onsubmit="return submitTwoFactor(event)">
            <label style="display:flex;align-items:center;gap:0.7rem;justify-content:center;">
                <span style="font-size:1.05rem;">Enable 2FA</span>
                <span class="toggle-switch"><input type="checkbox" id="enable2FA"><span class="slider"></span></span>
            </label><br>
            <button type="submit">Save</button>
        </form>
        <div style="margin-top:1rem;font-size:0.97rem;color:#888;">2FA adds an extra layer of security to your account. You'll be asked for a code when logging in from a new device.</div>
    </div></div>
    <div id="loginActivityModal" class="modal"><div class="modal-content"><h2>Recent Login Activity</h2>
        <div id="loginActivityList" style="max-height:220px;overflow-y:auto;text-align:left;margin-bottom:1rem;font-size:0.97rem;"></div>
        <button onclick="closeModal('loginActivityModal')">Close</button>
    </div></div>
    <div id="supportModal" class="modal"><div class="modal-content"><h2>Contact Support</h2>
        <div style="margin-bottom:1rem;font-size:1rem;color:#b31217;">
            <div><i class="fas fa-envelope"></i> <a href="mailto:bridgeflow24@gmail.com" style="color:#b31217;text-decoration:underline;">bridgeflow24@gmail.com</a></div>
            <div style="margin-top:0.3rem;"><i class="fas fa-phone"></i> <a href="tel:+919175005838" style="color:#b31217;text-decoration:underline;">+91 75005 5838</a></div>
        </div>
        <form id="supportForm" onsubmit="return submitSupport(event)">
            <textarea id="supportMsg" placeholder="Describe your issue..." style="width:90%;height:80px;padding:0.7rem;margin-bottom:1rem;" required></textarea><br>
            <button type="submit">Send</button>
        </form>
    </div></div>
    <div id="currentPlanModal" class="modal"><div class="modal-content" id="currentPlanContent">
        <!-- Plan info will be injected here -->
    </div></div>
    <div id="toast" style="display:none;position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:#b31217;color:#fff;padding:0.8rem 2rem;border-radius:20px;font-weight:600;z-index:9999;box-shadow:0 2px 8px rgba(179,18,23,0.10);font-size:1rem;">Setting saved!</div>
    <script>
    function openModal(id) {
        document.getElementById(id).style.display = 'flex';
    }
    function closeModal(id) {
        document.getElementById(id).style.display = 'none';
    }
    // Save toggles to localStorage and show toast
    function saveToggle(id) {
        const val = document.getElementById(id).checked;
        localStorage.setItem(id, val);
        showToast('Setting saved!');
    }
    // Restore toggles on load
    window.onload = function() {
        ['emailNotif','smsNotif','matchNotif','twoFactor'].forEach(id => {
            const el = document.getElementById(id);
            if(el && localStorage.getItem(id)!==null) el.checked = localStorage.getItem(id)==='true';
        });
    };
    function showToast(msg) {
        const toast = document.getElementById('toast');
        toast.textContent = msg;
        toast.style.display = 'block';
        setTimeout(()=>{toast.style.display='none';}, 1800);
    }
    // Close modals on click outside
    document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
            if (e.target === this) this.style.display = 'none';
        });
    });

    // Example API call (replace with your backend endpoint)
    async function fakeApiCall(endpoint, data) {
        // return fetch(endpoint, {method:'POST',body:JSON.stringify(data)});
        return new Promise(res=>setTimeout(res, 700));
    }

    // Change Email
    async function submitChangeEmail(e) {
        e.preventDefault();
        const email = document.getElementById('newEmail').value;
        // await fakeApiCall('/api/change-email', {email});
        localStorage.setItem('userEmail', email);
        closeModal('emailModal');
        showToast('Email updated!');
        return false;
    }
    // Change Password
    async function submitChangePassword(e) {
        e.preventDefault();
        const pwd = document.getElementById('newPassword').value;
        // await fakeApiCall('/api/change-password', {pwd});
        closeModal('passwordModal');
        showToast('Password updated!');
        return false;
    }
    // Delete Account
    async function deleteAccount() {
        // await fakeApiCall('/api/delete-account', {});
        localStorage.clear();
        closeModal('deleteModal');
        showToast('Account deleted!');
        setTimeout(()=>{window.location.href='index.html';}, 1200);
    }
    // Edit Profile
    async function submitEditProfile(e) {
        e.preventDefault();
        const name = document.getElementById('editName').value;
        const phone = document.getElementById('editPhone').value;
        // await fakeApiCall('/api/edit-profile', {name, phone});
        localStorage.setItem('userName', name);
        localStorage.setItem('userPhone', phone);
        closeModal('editProfileModal');
        showToast('Profile updated!');
        return false;
    }
    // Update Profile Pic
    async function submitProfilePic(e) {
        e.preventDefault();
        const file = document.getElementById('newProfilePic').files[0];
        if(file) {
            const reader = new FileReader();
            reader.onload = function(evt) {
                localStorage.setItem('profilePicture', evt.target.result);
            };
            reader.readAsDataURL(file);
        }
        // await fakeApiCall('/api/update-profile-pic', {file});
        closeModal('profilePicModal');
        showToast('Profile picture updated!');
        return false;
    }
    // Privacy
    async function submitPrivacy(e) {
        e.preventDefault();
        const hideProfile = document.getElementById('hideProfile').checked;
        const hideContact = document.getElementById('hideContact').checked;
        // await fakeApiCall('/api/privacy', {hideProfile, hideContact});
        localStorage.setItem('hideProfile', hideProfile);
        localStorage.setItem('hideContact', hideContact);
        closeModal('privacyModal');
        showToast('Privacy updated!');
        return false;
    }
    // 2FA
    async function submitTwoFactor(e) {
        e.preventDefault();
        const enable2FA = document.getElementById('enable2FA').checked;
        // await fakeApiCall('/api/2fa', {enable2FA});
        localStorage.setItem('twoFactor', enable2FA);
        closeModal('twoFactorModal');
        showToast('2FA setting updated!');
        return false;
    }
    // Support
    async function submitSupport(e) {
        e.preventDefault();
        const msg = document.getElementById('supportMsg').value;
        // await fakeApiCall('/api/support', {msg});
        closeModal('supportModal');
        showToast('Support message sent!');
        return false;
    }
    // FAQ accordion logic
    document.querySelectorAll('.faq-question').forEach(btn => {
        btn.addEventListener('click', function() {
            const item = this.parentElement;
            item.classList.toggle('active');
        });
    });
    function showFAQ() {
        document.getElementById('faqSection').style.display = 'block';
        setTimeout(()=>{
            document.getElementById('faqSection').scrollIntoView({behavior:'smooth'});
        }, 100);
    }
    function hideFAQ() {
        document.getElementById('faqSection').style.display = 'none';
    }
    // 2FA modal: sync toggle with localStorage
    document.getElementById('twoFactorModal').addEventListener('show', function() {
        document.getElementById('enable2FA').checked = localStorage.getItem('twoFactor') === 'true';
    });
    // Patch openModal to trigger 'show' event and handle current plan
    const _openModal = openModal;
    window.openModal = function(id) {
        _openModal(id);
        const modal = document.getElementById(id);
        if (modal) {
            const evt = new Event('show');
            modal.dispatchEvent(evt);
        }
        if (id === 'loginActivityModal') renderLoginActivity();
        if (id === 'currentPlanModal') renderCurrentPlan();
    };
    function renderLoginActivity() {
        const mockLogins = [
            { date: '2024-06-01 10:23', device: 'Chrome (Windows)', location: 'Mumbai, IN' },
            { date: '2024-05-30 21:10', device: 'Safari (iPhone)', location: 'Pune, IN' },
            { date: '2024-05-28 08:45', device: 'Edge (Windows)', location: 'Delhi, IN' }
        ];
        const list = document.getElementById('loginActivityList');
        list.innerHTML = mockLogins.map(l => `<div style="padding:0.5rem 0;border-bottom:1px solid #eee;"><b>${l.date}</b><br><span style='color:#b31217;'>${l.device}</span> &bull; <span>${l.location}</span></div>`).join('');
    }
    function renderCurrentPlan() {
        const planMap = {
            basic: {
                name: 'Basic Plan',
                features: ['Basic Profile Creation', 'View Limited Profiles', 'Basic Search Filters', 'Email Support'],
                color: '#888'
            },
            standard: {
                name: 'Standard Plan',
                features: ['Advanced Profile Creation', 'View All Profiles', 'Advanced Search Filters', 'Priority Support', 'Profile Highlighting'],
                color: '#b31217'
            },
            premium: {
                name: 'Premium Plan',
                features: ['Premium Profile Creation', 'Unlimited Profile Views', 'All Search Filters', '24/7 Priority Support', 'Profile Highlighting', 'Featured Profile Listing'],
                color: '#b31217'
            }
        };
        const sub = JSON.parse(localStorage.getItem('subscriptionDetails'));
        let html = '';
        if (sub && sub.planType) {
            const plan = planMap[sub.planType] || {name: sub.planType, features: [], color:'#888'};
            html = `<h2 style="color:${plan.color};margin-bottom:0.7rem;">${plan.name}</h2>
                <div style="margin-bottom:0.7rem;font-size:1.05rem;">Valid Until: <b>${new Date(sub.validUntil).toLocaleDateString()}</b></div>
                <div style="margin-bottom:0.7rem;font-size:1.05rem;">Payment ID: <b>${sub.paymentId||'-'}</b></div>
                <div style="margin-bottom:0.7rem;font-size:1.05rem;">Features:</div>
                <ul style="text-align:left;margin:0 0 1rem 0;padding-left:1.2rem;">${plan.features.map(f=>`<li>${f}</li>`).join('')}</ul>
                <button onclick="closeModal('currentPlanModal')">Close</button>`;
        } else {
            html = `<h2 style="color:#b31217;">No Active Plan</h2><p>You are currently not subscribed to any plan.</p><button onclick="closeModal('currentPlanModal')">Close</button>`;
        }
        document.getElementById('currentPlanContent').innerHTML = html;
    }
    </script>
</body>
</html> 